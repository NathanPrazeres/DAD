package dadkvs.server;

/* these imported classes are generated by the contract */
import dadkvs.DadkvsPaxos;
import dadkvs.DadkvsPaxosServiceGrpc;

import io.grpc.stub.StreamObserver;

public class DadkvsPaxosServiceImpl extends DadkvsPaxosServiceGrpc.DadkvsPaxosServiceImplBase {

	private DadkvsServerState _state;

	public DadkvsPaxosServiceImpl(DadkvsServerState state) {
		_state = state;
	}

	@Override
	public void phaseOne(DadkvsPaxos.Prepare request,
			StreamObserver<DadkvsPaxos.Promise> responseObserver) {
        // responseObserver.onNext(_state.paxosState.handlePrepareRequest(request));
		responseObserver.onCompleted();
	}

	@Override
	public void phaseTwo(DadkvsPaxos.Accept request,
			StreamObserver<DadkvsPaxos.Accepted> responseObserver) {
        // responseObserver.onNext(_state.paxosState.handleAccept(request));
		responseObserver.onCompleted();
	}

	@Override
	public void learn(DadkvsPaxos.LearnRequest request, StreamObserver<DadkvsPaxos.LearnReply> responseObserver) {
		_state.logSystem.writeLog("Learn request received");
		// responseObserver.onNext(response);
		responseObserver.onCompleted();
	}
}